<?php
namespace SlComponent\Util;

use Vendor\Spreadsheet\Excel\Reader as SpreadsheetExcelReader;

class ExcelCsvUtil{

    public static function getExcelHeaderFooter($addStyleClass=null){
        $result = array();
        $excelHeader = '<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">' . chr(10);
        $excelHeader .= '<head>' . chr(10);
        $excelHeader .= '<title>Excel Down</title>' . chr(10);
        $excelHeader .= '<meta http-equiv="Content-Type" content="text/html; charset=' . SET_CHARSET . '" />' . chr(10);
        $excelHeader .= '<style>' . chr(10);
        $excelHeader .= 'br{mso-data-placement:same-cell;}' . chr(10);
        $excelHeader .= '.xl31{mso-number-format:"0_\)\;\\\(0\\\)";}' . chr(10);
        $excelHeader .= '.xl24{mso-number-format:"\@";} ' . chr(10);
        $excelHeader .= '.title{font-weight:bold; background-color:#F6F6F6; text-align:center;} ' . chr(10);
        $excelHeader .= '.cwidth{width:900px} ' . chr(10);
        $excelHeader .= '.red{color:ff0000} ' . chr(10);
        $excelHeader .= '.tcenter{text-align:center} ' . chr(10);

        if(!empty($addStyleClass)){
            foreach( $addStyleClass as $addStyle ){
                $excelHeader .= $addStyle;
            }
        }

        $excelHeader .= '</style>' . chr(10);
        $excelHeader .= '</head>' . chr(10);
        $excelHeader .= '<body>' . chr(10);
        $excelFooter = '</body>' . chr(10);
        $excelFooter .= '</html>' . chr(10);

        $result['header'] = $excelHeader;
        $result['footer'] = $excelFooter;
        return $result;
    }

    public static function cv($str){
        return iconv("utf8", "euckr", $str);
    }

    public static function listToCv($list){
        foreach( $list as $key => $each ){
            $list[$key] = self::cv('"'.$each.'"');
        }
        return $list;
    }

    public static function listToCv2($list1){
        foreach( $list1 as $key1 => $list2 ){
            foreach( $list2 as $key2 => $each ){
                $list1[$key1][$key2] = self::cv('"'.$each.'"');
            }
        }
        return $list1;
    }

    public static function wrapTd($str , $class=null, $style=null, $etcTag=null){
        return self::wrapTag($str, "td", $class, $style, $etcTag);
    }
    public static function wrapTh($str , $class='title', $style=null, $etcTag=null){
        return self::wrapTag($str, "th", $class, $style, $etcTag);
    }
    public static function wrapTag($str, $tag , $class=null, $style=null, $etcTag=null){
        $includeClass = empty($class)?'':'class="'.$class.'"';
        $style = empty($style)?'':'style="'.$style.'"';
        $etcTag = empty($etcTag)?'':$etcTag.'"';
        return "<{$tag} {$includeClass} {$style} {$etcTag} >{$str}</{$tag}>";
    }

    public static function improvedCheckAndRead($filesValue, $readBeginRowNo = 4){
        $result =  ExcelCsvUtil::checkAndRead($filesValue, $readBeginRowNo);
        if( empty($result['isOk'])  ){
            throw new \Exception($result['failMsg']);
        }
        $sheetData = $result['data']->sheets[0];
        $sheetData = $sheetData['cells'];
        return array_splice($sheetData,$readBeginRowNo-1,count($sheetData)-1);
    }

    public static function checkAndRead($filesValue, $readBeginRowNo = 4){

        $result = array();
        $excelChk = true;
        if ($filesValue['excel']['error'] > 0) {
            $failMsg = __('엑셀 화일이 존재하지 않습니다. 다운 로드 받으신 엑셀파일을 이용해서 "Excel 97-2003 통합문서" 로 저장이 된 엑셀 파일만 가능합니다.');
            $excelChk = false;
        }

        $data = new SpreadsheetExcelReader();
        $data->setOutputEncoding('UTF-8');
        $chk = $data->read($filesValue['excel']['tmp_name']);

        if ($chk === false) {
            $failMsg = __('엑셀 화일을 확인해 주세요. 다운 로드 받으신 엑셀파일을 이용해서 "Excel 97-2003 통합문서" 로 저장이 된 엑셀 파일만 가능합니다.');
            $excelChk = false;
        }

        // 반드시 Excel 97-2003 통합문서로 저장이 되어야 하며, 1번째 줄은 설명, 2번째 줄은 excel DB 코드, 3번째 줄은 설명 이며, 4번째 줄부터 데이타 입니다.
        if ($data->sheets[0]['numRows'] < $readBeginRowNo) {
            $failMsg = $data->sheets[0]['numRows'].__('엑셀 화일을 확인해 주세요. 엑셀 데이타가 존재하지 않습니다. 데이타는 '.$readBeginRowNo.'번째 줄부터 작성을 하셔야 합니다.');
            $excelChk = false;
        }

        $result['isOk'] = $excelChk;
        $result['failMsg'] = $failMsg;
        $result['data'] = $data;

        return $result;
    }

    public static function getExcelHeaderFooterNew(){
        $result = array();
        $excelHeader = '<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">' . chr(10);
        $excelHeader .= '<head>' . chr(10);
        $excelHeader .= '<title>Excel Down</title>' . chr(10);
        $excelHeader .= '<meta http-equiv="Content-Type" content="text/html; charset=' . SET_CHARSET . '" />' . chr(10);
        $excelHeader .= '<style>' . chr(10);
        $excelHeader .= 'html { font-family:Calibri, Arial, Helvetica, sans-serif; font-size:11pt; background-color:white } table { border-collapse:collapse; page-break-after:always } .gridlines td { border:1px dotted black } .gridlines th { border:1px dotted black } .b { text-align:center } .e { text-align:center } .f { text-align:right } .inlineStr { text-align:left } .n { text-align:right } .s { text-align:left } td.style0 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } th.style0 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } td.style1 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } th.style1 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } td.style2 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style2 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style3 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style3 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style4 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:2px solid #000000 !important; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style4 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:2px solid #000000 !important; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style5 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style5 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style6 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style6 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style7 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style7 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style8 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style8 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style9 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; text-decoration:underline; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style9 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; text-decoration:underline; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style10 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; text-decoration:underline; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style10 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; text-decoration:underline; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style11 { vertical-align:bottom; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"신그래픽체"; font-size:10pt; background-color:white } th.style11 { vertical-align:bottom; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"신그래픽체"; font-size:10pt; background-color:white } td.style12 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; text-decoration:underline; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style12 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; text-decoration:underline; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style13 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; text-decoration:underline; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style13 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; text-decoration:underline; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style14 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style14 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style15 { vertical-align:middle; border-bottom:3px double #000000 !important; border-top:none #000000; border-left:none #000000; border-right:2px solid #000000 !important; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } th.style15 { vertical-align:middle; border-bottom:3px double #000000 !important; border-top:none #000000; border-left:none #000000; border-right:2px solid #000000 !important; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#FFFFFF } td.style16 { vertical-align:bottom; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } th.style16 { vertical-align:bottom; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } td.style17 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#C0C0C0 } th.style17 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#C0C0C0 } td.style18 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } th.style18 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } td.style19 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } th.style19 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } td.style20 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } th.style20 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } td.style21 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } th.style21 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } td.style22 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } th.style22 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } td.style23 { vertical-align:bottom; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } th.style23 { vertical-align:bottom; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } td.style24 { vertical-align:bottom; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } th.style24 { vertical-align:bottom; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"신그래픽체"; font-size:11pt; background-color:white } td.style25 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"돋움"; font-size:11pt; background-color:#C0C0C0 } th.style25 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"돋움"; font-size:11pt; background-color:#C0C0C0 } td.style26 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"돋움"; font-size:11pt; background-color:#C0C0C0 } th.style26 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"돋움"; font-size:11pt; background-color:#C0C0C0 } td.style27 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:3px double #000000 !important; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#C0C0C0 } th.style27 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:3px double #000000 !important; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#C0C0C0 } td.style28 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:3px double #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#C0C0C0 } th.style28 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:3px double #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#C0C0C0 } td.style29 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:3px double #000000 !important; border-left:none #000000; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#C0C0C0 } th.style29 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:3px double #000000 !important; border-left:none #000000; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"돋움"; font-size:10pt; background-color:#C0C0C0 } td.style30 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style30 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style31 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style31 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style32 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#FF0000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style32 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#FF0000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style33 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#FF0000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style33 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#FF0000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style34 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; font-weight:bold; color:#FF0000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style34 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; font-weight:bold; color:#FF0000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style35 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:2px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style35 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:2px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style36 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style36 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style37 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style37 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style38 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style38 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style39 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style39 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style40 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style40 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style41 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style41 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style42 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:2px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style42 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:2px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style43 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style43 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style44 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style44 { vertical-align:middle; text-align:center; border-bottom:3px double #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style45 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:#C0C0C0 } th.style45 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:#C0C0C0 } td.style46 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:#C0C0C0 } th.style46 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:#C0C0C0 } td.style47 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:white } th.style47 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:white } td.style48 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:white } th.style48 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:white } td.style49 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:2px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:white } th.style49 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:2px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:15pt; background-color:white } td.style50 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style50 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style51 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style51 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style52 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style52 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style53 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style53 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style54 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } th.style54 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#FFFFFF } td.style55 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } th.style55 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } td.style56 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } th.style56 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } td.style57 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } th.style57 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } td.style58 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } th.style58 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } td.style59 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } th.style59 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } td.style60 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } th.style60 { vertical-align:middle; text-align:center; border-bottom:2px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:white } td.style61 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:2px solid #000000 !important; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } th.style61 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:2px solid #000000 !important; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } td.style62 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } th.style62 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } td.style63 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } th.style63 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:2px solid #000000 !important; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } td.style64 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } th.style64 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:"돋움"; font-size:11pt; background-color:white } td.style65 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } th.style65 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } td.style66 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } th.style66 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } td.style67 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:none #000000; border-right:2px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } th.style67 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000 !important; border-left:none #000000; border-right:2px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } td.style68 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } th.style68 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } td.style69 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } th.style69 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } td.style70 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:2px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } th.style70 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:2px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:20pt; background-color:#FFFFFF } td.style71 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style71 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:2px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style72 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style72 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } td.style73 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } th.style73 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:2px solid #000000 !important; border-left:1px solid #000000 !important; border-right:2px solid #000000 !important; font-weight:bold; color:#000000; font-family:"맑은 고딕"; font-size:11pt; background-color:#C0C0C0 } table.sheet0 col.col0 { width:20.3333331pt } table.sheet0 col.col1 { width:20.3333331pt } table.sheet0 col.col2 { width:20.3333331pt } table.sheet0 col.col3 { width:20.3333331pt } table.sheet0 col.col4 { width:20.3333331pt } table.sheet0 col.col5 { width:20.3333331pt } table.sheet0 col.col6 { width:20.3333331pt } table.sheet0 col.col7 { width:20.3333331pt } table.sheet0 col.col8 { width:20.3333331pt } table.sheet0 col.col9 { width:20.3333331pt } table.sheet0 col.col10 { width:20.3333331pt } table.sheet0 col.col11 { width:20.3333331pt } table.sheet0 col.col12 { width:20.3333331pt } table.sheet0 col.col13 { width:20.3333331pt } table.sheet0 col.col14 { width:20.3333331pt } table.sheet0 col.col15 { width:20.3333331pt } table.sheet0 col.col16 { width:20.3333331pt } table.sheet0 col.col17 { width:20.3333331pt } table.sheet0 col.col18 { width:20.3333331pt } table.sheet0 col.col19 { width:20.3333331pt } table.sheet0 col.col20 { width:20.3333331pt } table.sheet0 col.col21 { width:20.3333331pt } table.sheet0 tr { height:13.5pt } table.sheet0 tr.row0 { height:17.1pt } table.sheet0 tr.row1 { height:24.95pt } table.sheet0 tr.row2 { height:20.1pt } table.sheet0 tr.row3 { height:17.1pt } table.sheet0 tr.row4 { height:17.1pt } table.sheet0 tr.row5 { height:17.1pt } table.sheet0 tr.row6 { height:17.1pt } table.sheet0 tr.row7 { height:17.1pt } table.sheet0 tr.row8 { height:17.1pt } table.sheet0 tr.row9 { height:17.1pt } table.sheet0 tr.row10 { height:17.1pt } table.sheet0 tr.row11 { height:17.1pt } table.sheet0 tr.row12 { height:17.1pt } table.sheet0 tr.row13 { height:17.1pt } table.sheet0 tr.row14 { height:17.1pt } table.sheet0 tr.row15 { height:17.1pt } table.sheet0 tr.row16 { height:17.1pt } table.sheet0 tr.row17 { height:17.1pt } table.sheet0 tr.row18 { height:17.1pt } table.sheet0 tr.row19 { height:17.1pt } table.sheet0 tr.row20 { height:17.1pt } table.sheet0 tr.row21 { height:17.1pt } table.sheet0 tr.row22 { height:17.1pt } table.sheet0 tr.row23 { height:17.1pt } table.sheet0 tr.row24 { height:17.1pt } table.sheet0 tr.row25 { height:17.1pt } table.sheet0 tr.row26 { height:17.1pt } table.sheet0 tr.row27 { height:17.1pt } table.sheet0 tr.row28 { height:17.1pt } table.sheet0 tr.row29 { height:17.1pt } table.sheet0 tr.row30 { height:17.1pt } table.sheet0 tr.row31 { height:17.1pt } table.sheet0 tr.row32 { height:17.1pt } table.sheet0 tr.row33 { height:17.1pt } table.sheet0 tr.row34 { height:17.1pt } table.sheet0 tr.row35 { height:17.1pt } table.sheet0 tr.row36 { height:17.1pt } table.sheet0 tr.row37 { height:17.1pt } table.sheet0 tr.row38 { height:17.1pt } table.sheet0 tr.row39 { height:17.1pt } table.sheet0 tr.row40 { height:17.1pt } table.sheet0 tr.row41 { height:17.1pt }' . chr(10);
        $excelHeader .= '</style>' . chr(10);
        $excelHeader .= '</head>' . chr(10);
        $excelHeader .= '<body>' . chr(10);
        $excelFooter = '</body>' . chr(10);
        $excelFooter .= '</html>' . chr(10);

        $result['header'] = $excelHeader;
        $result['footer'] = $excelFooter;
        return $result;
    }

    /**
     * 일반적인 엑셀 파일 데이터 가져오기.
     * @param $files
     * @param $startRowCnt
     * @return mixed
     * @throws \Exception
     */
    public static function getUploadData($files, $startRowCnt){
        $result = ExcelCsvUtil::checkAndRead($files,$startRowCnt);
        if( empty($result['isOk'])  ){
            throw new \Exception($result['failMsg']);
        }
        return $result['data']->sheets[0]['cells'];
    }

    /**
     * @param $files
     * @param $params
     * @param int $startRowCnt
     * @return mixed
     * @throws \Exception
     */
    public static function runExcelReadAndProcess($files, $params, $startRowCnt = 1){
        if( !empty($files) ){
            $sheetData = ExcelCsvUtil::improvedCheckAndRead($files,$startRowCnt);
            \SiteLabUtil\SlCommonUtil::setEachData($sheetData, $params['instance'], $params['fnc'], $params['mixData']);
            return $params['mixData'];
        }
    }


    /**
     * 리스트를 심플하게 그대로 다운로드
     * @param $list
     * @param $fileName
     */
    public static function downloadList($list, $fileName){

        $title = [];
        $excelBody = '';
        foreach($list as $key => $each){
            $fieldData = array();
            foreach($each as $valueKey => $value){
                if($key===0){
                    $title[] = $valueKey;
                }
                $fieldData[] = ExcelCsvUtil::wrapTd($value,'text','mso-number-format:\'\@\'');
                //gd_debug($value);
            }
            $excelBody .=  "<tr>". implode('',$fieldData) . "</tr>";
        }
        //gd_debug( $title );

        $simpleExcelComponent = SlLoader::cLoad('Excel','SimpleExcelComponent','sl');
        $simpleExcelComponent->simpleDownload($fileName,$title,$excelBody);

    }


}